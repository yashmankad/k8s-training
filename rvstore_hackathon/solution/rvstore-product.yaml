apiVersion: v1
kind: ConfigMap
metadata:
  name: rvstore-product-api-config
  namespace: default
data:
  PRODUCT_FILE_LOCATION: /data/products
  products.json: |
    [
    {"id":"sewer-hose","name":"Stinky Slinky Sewer Hose","price":19.99,"description":"Oh what fun times you'll have with this! Be sure to stock up on gloves and disinfectant soap before checkout!","image":"https://campaddict.com/wp-content/uploads/RV-sewer-hose-in-use.jpg"},
    {"id":"electric-jacks","name":"Six-Point Auto-Leveling Jacks","price":3499.99,"description":"Six-point electric auto-leveling jacks for your travel trailer or fifth wheel. No more yelling at your spouse for getting the number of wood blocks wrong! Just push a button and walk away!","image":"https://cdn3.volusion.com/dxylq.nruds/v/vspfiles/photos/8735-2.jpg?1536058347"},
    {"id":"heated-hose","name":"Heated Fresh Water Hose","price":89.99,"description":"Heated hose for those freezing nights","image":"https://i5.walmartimages.com/asr/9b926f3b-cdd5-4bcc-b09b-ef44d461c023_2.e4c509076a08564a97b13b61ea0c45da.jpeg"},
    {"id":"50-amp-extension-cord","name":"25' 50 amp Extension Cord","price":89.99,"description":"Quit parking your RV based on where the post is!","image":"https://images-na.ssl-images-amazon.com/images/I/71t4SHO3EML._SX425_.jpg"},
    {"id":"5th-wheel-tripod","name":"5th Wheel Tripod Stabilizer","price":127.49,"description":"This rig won't be a rockin' when you have this tripod stabilizer on your 5th wheel hitch.","image":"https://www.etrailer.com/static/images/faq/review-ultrafab-5th-wheel-king-pin-tripod-stabilizer-uf19-950001_644.jpg"},
    {"id":"companion","name":"B&W Companion 25K Fifth Wheel Hitch","price":1262.00,"description":"Specially designed to attach to the receivers in your factory 5th-wheel towing prep package, the Companion OEM features a dual jaw for excellent jaw-to-king-pin contact and a cam-action handle for simple release. Easily remove for full bed access.","image":"https://www.wickedrigs.com/pub/media/catalog/product/cache/image/1000x1320/e9c3970ab036de70892d86c6d221abfe/c/o/companion-in-bed.product_1.jpg"}
    ]

---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: rvstore-product-api
  labels:
    app: rvstore-product-api
spec:
  replicas: 1
  selector:
    matchLabels:
      app: rvstore-product-api
  template:
    metadata:
      labels:
        app: rvstore-product-api
    spec:
      containers:
      - name: rvstore-product-api
        image: public.ecr.aws/e7e6w2e3/rvstore-product-api
        envFrom:
        - configMapRef:
            name: rvstore-product-api-config
        volumeMounts:
        - name: rvstore-product-api-config-volume
          mountPath: /data/products
      volumes:
        - name: rvstore-product-api-config-volume
          configMap:
            name: rvstore-product-api-config

---

apiVersion: v1
kind: Service
metadata:
  name: rvstore-product-api
spec:
  selector:
    app: rvstore-product-api
  ports:
  - protocol: TCP
    port: 9001
    nodePort: 30082
  type: NodePort
